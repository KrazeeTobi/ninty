!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a,jQuery):a.Polaris=b(a,jQuery)}((this||0).self||global,function(a,b){"use strict";var c={},d={},e={},f={},g={},h={},i={},j=a.document?document.documentElement.className.split(" "):[],k=function(){var a=function(a){this.seeds=[123456789,362436069,521288629,88675123],"number"!=typeof a&&(a=+new Date),this.seeds[2]^=a,this.seeds[2]^=this.seeds[2]>>21,this.seeds[2]^=this.seeds[2]<<35,this.seeds[2]^=this.seeds[2]>>4,this.seeds[2]*=268582165,this.get(),this.get()};return a.prototype.get=function(a,b){var c=this.seeds[0]^this.seeds[0]<<11;this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3];var d=this.seeds[3]=this.seeds[3]^this.seeds[3]>>19^(c^c>>8);return arguments.length>=2?a+d%(b-a+1):d},a}();if(a.navigator){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=a.navigator.userAgent.toLowerCase();-1!=Q.indexOf("msie")?(l=!0,Q.match(/msie (\d+\.\d)/),m=parseFloat(RegExp.$1)):-1!=Q.indexOf("trident")?(l=!0,Q.match(/rv:(\d+\.\d)/),m=parseFloat(RegExp.$1)):-1!=Q.indexOf("chrome")?(n=!0,Q.match(/chrome[\/ ]?(\d+\.\d+)/),o=parseFloat(RegExp.$1)):-1!=Q.indexOf("firefox")?(p=!0,Q.match(/firefox[\/ ]?(\d+\.\d+)/),q=parseFloat(RegExp.$1)):-1!=Q.indexOf("opera")?(t=!0,Q.match(/opera[\/ ]?(\d+\.\d+)/),u=parseFloat(RegExp.$1)):-1!=Q.indexOf("safari")&&(r=!0,Q.match(/version[\/ ]?(\d+\.\d+)/),s=parseFloat(RegExp.$1)),-1!=Q.indexOf("iphone")?(w=!0,Q.match(/iphone os (\d+)_(\d+)/),z=1*RegExp.$1+.1*RegExp.$2):-1!=Q.indexOf("ipad")?(x=!0,Q.match(/cpu os (\d+)_(\d+)/),z=1*RegExp.$1+.1*RegExp.$2):-1!=Q.indexOf("ipod")?(y=!0,Q.match(/os (\d+)_(\d+)/),z=1*RegExp.$1+.1*RegExp.$2):-1!=Q.indexOf("android")?(B=!0,Q.match(/android (\d+\.\d)/),E=parseFloat(RegExp.$1),-1!=Q.indexOf("mobile")?C=!0:D=!0):-1!=Q.indexOf("windows phone")?F=!0:(-1!==Q.indexOf("blackberry")||-1!==Q.indexOf("bb10"))&&(A=!0),-1!=Q.indexOf("mac os")&&(v=!0),-1!=Q.indexOf("nexus 7")&&(G=!0),-1!=Q.indexOf("playstation 3")&&(L=!0),-1!=Q.indexOf("playstation 4")&&(M=!0),-1!=Q.indexOf("playstation portable")&&(N=!0),-1!=Q.indexOf("playstation vita")&&(O=!0),-1!=Q.indexOf("nintendo")&&(-1!=Q.indexOf("dsi;")?I=!0:-1!=Q.indexOf("3ds;")?H=!0:-1!=Q.indexOf("wii;")?J=!0:-1!=Q.indexOf("wiiu")&&(K=!0)),-1!=Q.indexOf("mac os")&&(v=!0),-1!=Q.indexOf("nexus 7")&&(G=!0),(-1!=Q.indexOf("googlebot")||-1!=Q.indexOf("yahoo")||-1!=Q.indexOf("msnbot"))&&(P=!0),c={ie:l,ie6:6==m,ie7:7==m,ie8:8==m,ie9:9==m,ie10:10==m,ie11:11==m,iegt6:!!(m>6),iegt7:!!(m>7),iegt8:!!(m>8),iegt9:!!(m>9),iegt10:!!(m>10),iegt11:!!(m>11),ielt6:!!(l&&6>m),ielt7:!!(l&&7>m),ielt8:!!(l&&8>m),ielt9:!!(l&&9>m),ielt10:!!(l&&10>m),ielt11:!!(l&&11>m),chrome:n,firefox:p,opera:t,safari:r,iphone:!!w,ipad:!!x,ipod:!!y,ios:!!(w||x||y),android:!!B,androidmobile:!!C,androidtablet:!!D,windowsphone:!!F,smartdevice:!!(w||x||y||B||F||A),mobile:!!(w||y||C||F),tablet:!!x||!!D,nexus7:!!G,blackberry:!!A,ps3:!!L,ps4:!!M,psp:!!N,psv:!!O,n3ds:!!H,ndsi:!!I,nwii:!!J,nwiiu:!!K,bot:!!P,version:{ie:m,firefox:q,chrome:o,safari:s,opera:u,android:E,ios:z}}}f=function(){var b=null,d=new k,e={},f=0,g=0,i=null,j=null,l=null,m=function(a){return"[object Object]"===Object.prototype.toString.call(a)},n=function(a){return"[object Array]"===Object.prototype.toString.call(a)},o=function(a){return"[object Function]"===Object.prototype.toString.call(a)},p=function(a){return"[object Number]"===Object.prototype.toString.call(a)},q=function(a){return"[object Boolean]"===Object.prototype.toString.call(a)},r=function(a){return"[object String]"===Object.prototype.toString.call(a)},s=function(a){return null===a},t=function(a){b=new k(a)},u=function(a,c){return null===b&&(b=new k),b.get(a,c)},v=function(a){var b="",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";a=a&&!isNaN(a)?parseInt(a):10;for(var f=0;a>f;f++)b+=c.charAt(d.get(0,c.length-1));return b in e?uniqueString(a+1):(e[b]=1,b)},w=function(a,b){if(p(a)){var c=(a+"").length;if(b>c)for(var d=0;b-c>d;d++)a="0"+a;return a+""}return a+""},x=function(a,b,c){return Math.min(c,Math.max(b,a))},y=function(a){if(r(a)){for(var b=a.split("-"),c=0;c<b.length;c++)b[c]=b[c].charAt(0).toUpperCase()+b[c].slice(1);return b.join("")}return a},z=function(a){return r(a)?a.split(/(?=[A-Z])/).join("-").toLowerCase():a},A=function(a){var b=[0,0,0];r(a)&&(a.match(/#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/)?(b[0]=RegExp.$1,b[1]=RegExp.$2,b[2]=RegExp.$3):a.match(/#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/)&&(b[0]=RegExp.$1+""+RegExp.$1,b[1]=RegExp.$2+""+RegExp.$2,b[2]=RegExp.$3+""+RegExp.$3));for(var c=[0,0,0],d=0;3>d;d++)c[d]=parseInt(b[d],16);return c},B=function(a){if(n(a))var b=a[0].toString(16),c=a[1].toString(16),d=a[2].toString(16);else var b=arguments[0].toString(16),c=arguments[1].toString(16),d=arguments[2].toString(16);return 1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),1==d.length&&(d="0"+d),"#"+b+c+d},C=function(a){for(var b=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,d=c.exec(a||location.href),e={},f=b.length;f--;)e[b[f]]=d[f]||"";return e},D=function(a){var b={};if(a||(a=location.search),a=a&&-1!==a.indexOf("?")?a.split("?")[1]:!1)for(var c=a.replace("&amp;","&").split("&"),d=0;d<c.length;d++)if(-1!=c[d].indexOf("=")){var e=c[d].split("=");b[e[0]]=e[1]}else b[c[d]]="";return b},E=function(a,b){if(a&&n(a)){if(!b&&void 0!==b){for(var c=[],d=0;d<a.length;d++)c[d]=d;for(var d=0;d<c.length;d++){var e=util.rand(0,c.length),f=c[d];c[d]=c[e],c[e]=f}for(var d=0;d<c.length;d++)c[d]=a[c[d]];return c}for(var d=0;d<a.length;d++){var e=util.rand(0,a.length),f=a[d];a[d]=a[e],a[e]=f}}},F=function(a,b){return a&&r(a)&&(a=a.replace(/</gim,"&lt;").replace(/>/gim,"&gt;"),b&&(a=a.replace(/[\\n]/g,"<br />"))),a},G=function(){var b=0,c=0;return p(a.innerWidth)?(b=Math.min(a.innerWidth,a.document.documentElement.clientWidth),c=a.innerHeight):(b=a.document.documentElement.clientWidth,c=a.document.documentElement.clientHeight),{w:b,h:c}},H=function(b,c){var d=v(10);if(o(b)){var e=void 0!==c?c:a;if(null===i){i={};var h=G();f=h.w,g=h.h;var j=function(){var a=G();f=a.w,g=a.h;for(var b in i)i[b].callable.call(i[b].thisObject,f,g)};a.addEventListener?(a.addEventListener("resize",j,!1),a.addEventListener("orientationchange",function(){setTimeout(j,1e3)},!1)):a.attachEvent("onresize",j)}i[d]={callable:b,thisObject:e},b.call(e,f,g)}return d},I=function(a){null!==i&&r(a)&&a in i&&delete i[a]},J=function(b,d){var e=v(10);if(o(b)){var i=void 0!==d?d:a;if(null===j){j={};var k=function(){var b=G(),c=a.document.body.scrollTop||a.document.documentElement.scrollTop,d=a.document.body.scrollLeft||a.document.documentElement.scrollLeft,e=c+b.h,f=d+b.w;for(var g in j)j[g].callable.call(j[g].thisObject,c,e,d,f)};window.addEventListener?a.addEventListener("scroll",k,!1):a.attachEvent("onscroll",k),h.hasTouch&&c.ios&&a.addEventListener("touchmove",k,!1)}if(j[e]={callable:b,thisObject:i},a.document.body){var l=a.document.body.scrollTop||a.document.documentElement.scrollTop,m=a.document.body.scrollLeft||a.document.documentElement.scrollLeft,n=l+g,p=m+f;b.call(i,l,n,m,p)}}return e},K=function(a){null!==j&&r(a)&&a in j&&delete j[a]},L=function(b,c){var d=v(10);if(o(b)){var e=void 0!==c?c:a;if(null===l){l={};var f=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||a.mozRequestAnimationFrame||a.setTimeout,g=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame||a.mozCancelAnimationFrame||a.clearTimeout,h=null,i=1e3/60,j=function(){var a,b,c=+new Date;for(var d in l)a=c-l[d].t1,b=c-l[d].t0,l[d].t1=c,l[d].callable.call(l[d].thisObject,c,a,b)===!1&&delete l[d];0===Object.keys(l).length?(g(h),l=null):h=f(j,i)};h=f(j,i)}l[d]={t0:+new Date,t1:+new Date,callable:b,thisObject:e}}return d},M=function(a){null!==l&&r(a)&&a in l&&delete l[a]};return{isObject:m,isArray:n,isFunction:o,isNumber:p,isBoolean:q,isString:r,isNull:s,srand:t,rand:u,zeroPad:w,clamp:x,hyphen2camel:y,camel2hyphen:z,unique:v,hex2rgb:A,rgb2hex:B,parseURI:C,parseParam:D,shuffle:E,sanitize:F,onResize:H,offResize:I,onScroll:J,offScroll:K,onFrame:L,offFrame:M}}(),a.document&&(d=function(){var b=document.createElement("div").style,d="",e="",g="zoom"in b,h="opacity"in b,i="box-shadow"in b||"boxShadow"in b,j="border-radius"in b||"borderRadius"in b,k="background-size"in b||"backgroundSize"in b,l=!1,m=!1,n=!1,o=!1,p=!1,q=!1,r={translate:"1px, 1px",translate3d:"1px, 1px, 1px",translateX:"1px",translateY:"1px",translateZ:"1px",scale:"0, 0",scale3d:"0, 0, 0",scaleX:"1",scaleY:"1",scaleZ:"1",rotate:"1deg",rotate3d:"1, 1, 1, 1deg",rotateX:"1deg",rotateY:"1deg",rotateZ:"1deg",skew:"1deg, 1deg",skewX:"1deg",skewY:"1deg",matrix:"1, 0, 0, 1, 1, 1",matrix3d:"1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1",perspective:"100px"};if(e=function(){var a=["o","ms","moz","Moz","webkit",""];d="";for(var c=1;c<a.length;c++)if(a[c]+"Transform"in b)return""!==a[c]?(d=a[c].toLowerCase(),"-"+d+"-"):(d="","");return""}(),l=function(){for(var a=["oT","msT","mozT","MozT","webkitT","t"],c=0;c<a.length;c++){var d=a[c]+"ransition";if(d in b&&(b[d]="",b[d]="left 1ms linear 1ms",""!=b[d]))return n=0==d.indexOf("webkit")?"webkitTransitionEnd":"transitionend",!0}return!1}(),m=function(){for(var a=["oA","msA","mozA","MozA","webkitA","a"],c=0;c<a.length;c++){var d=a[c]+"nimation";if(d in b&&(b[d]="",b[d]="check 1ms ease 0ms infinite",""!=b[d]))return!0}return!1}(),o=function(){for(var d=["oF","msF","mozF","MozF","webkitF","f"],e=0;e<d.length;e++){var f=d[e]+"ilter";if(f in b&&(b[f]="",b[f]="blur(10px)",""!=b[f]))return c.ie?"function"==typeof a.history.pushState:!0}return!1}(),p=function(){if(!f.isFunction(a.matchMedia)){if(f.isFunction(a.msMatchMedia))return!!a.msMatchMedia("all").matches;var b=document.createElement("div"),d=document.createElement("div"),e="<style>@media all and (min-width: 0px) {#mqdummyelement{position:absolute;}}</style>",g=document.getElementsByTagName("head")[0];b.innerHTML=e,g.appendChild(b),d.setAttribute("id","mqdummyelement"),b.appendChild(d);var h="absolute"==(window.getComputedStyle?getComputedStyle(d,null):d.currentStyle).position;return g.removeChild(b),h}try{return!!a.matchMedia("all").matches}catch(i){return c.firefox&&a.parent!=a}}(),"transform"in b||e+"transform"in b)for(var s in r){var t=s+"("+r[s]+")";b[e+"transform"]="",b[e+"transform"]=t,""!==b[e+"transform"]?r[s]=!0:r[s]=!1}else for(var s in r)r[s]=!1;return{vendor:d,prefix:e,hasZoom:g,hasOpacity:h,hasBoxShadow:i,hasBorderRadius:j,hasBackgroundSize:k,hasTransition:l,hasAnimation:m,hasFilter:o,hasMediaQuery:p,hasPositionFixed:q,transform:r,transitionEnd:n}}()),a.document&&(e=function(){var b=!1;try{b=!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(c){b=void 0!=navigator.mimeTypes["application/x-shockwave-flash"]}return{hasFlash:b,hasCanvas:!!a.document.createElement("canvas").getContext,hasVideo:!!a.document.createElement("video").canPlayType,hasAudio:!!a.document.createElement("audio").canPlayType,hasSvg:!(!a.document.createElementNS||!a.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),hasWebgl:!!a.WebGLRenderingContext,hasGeolocation:"geolocation"in a.navigator,hasWebsocket:"WebSocket"in a||"MozWebSocket"in a,hasWebworkers:"Worker"in window,hasLocalStorage:"localStorage"in a,hasSessionStorage:"sessionStorage"in a,hasFormdata:"FormData"in a,hasDragndrop:"ondrop"in a.document.createElement("div"),hasWebaudio:"AudioContext"in a||"webkitAudioContext"in a}}()),a.document&&(g={hasOrientationchange:"onorientationchange"in a,hasHashchange:"onhashchange"in a,hasPushstate:"function"==typeof a.history.pushState&&"onpopstate"in a,hasDevicemotion:"ondevicemotion"in a,hasPropertychange:"onpropertychange"in a.document.documentElement}),a.document&&(h={hasTouch:"TouchEvent"in a,hasMotion:"ondevicemotion"in a,hasOrientation:"undefined"!=typeof a.orientation,pixelRatio:a.devicePixelRatio?a.devicePixelRatio:1});var R={linear:null,swing:[.25,.1,.25,1],iX2:[.55,.085,.68,.53],oX2:[.25,.46,.45,.94],ioX2:[.455,.03,.515,.955],iX3:[.55,.055,.675,.19],oX3:[.215,.61,.355,1],ioX3:[.645,.045,.355,1],iX4:[.895,.03,.685,.22],oX4:[.165,.84,.44,1],ioX4:[.77,0,.175,1],iX5:[.755,.05,.855,.06],oX5:[.23,1,.32,1],ioX5:[.86,0,.07,1],iSin:[.47,0,.745,.715],oSin:[.39,.575,.565,1],ioSin:[.445,.05,.55,.95],iExp:[.95,.05,.795,.035],oExp:[.19,1,.22,1],ioExp:[1,0,0,1],iCirc:[.6,.04,.98,.335],oCirc:[.075,.82,.165,1],ioCirc:[.785,.135,.15,.86],iBack:[.6,-.28,.735,.045],oBack:[.175,.885,.32,1.275],ioBack:[.68,-.55,.265,1.55]};if(i={iX2:function(a){return a*a},oX2:function(a){return-a*(a-2)},ioX2:function(a){return.5>a?2*a*a:1-2*--a*a},oiX2:function(a){return.5>a?-2*a*(a-1):1+2*a*(a-1)},iX3:function(a){return a*a*a},oX3:function(a){return 1+--a*a*a},ioX3:function(a){return.5>a?4*a*a*a:1+4*--a*a*a},iX4:function(a){return a*a*a*a},oX4:function(a){return 1- --a*a*a*a},ioX4:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},iX5:function(a){return a*a*a*a*a},oX5:function(a){return 1+--a*a*a*a*a},ioX5:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a},iExp:function(a){return Math.exp(10*(a-1))},oExp:function(a){return 1-Math.exp(-10*a)},ioExp:function(a){return.5>a?.5*Math.exp(10*(2*a-1)):1-.5*Math.exp(-10*(a-.5)*2)},iSin:function(a){return 1-Math.cos(a*Math.PI/2)},oSin:function(a){return Math.sin(a*Math.PI/2)},ioSin:function(a){return.5-.5*Math.cos(a*Math.PI)},iBack:function(a){var b=1.8;return a*a*((b+1)*a-b)},oBack:function(a){var b=1.8;return 1+(a-1)*(a-1)*((b+1)*(a-1)+b)},ioBack:function(a){},iCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},oCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},ioCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},elastic:function(a){return i.elastic(a,3,.1,.4)},elastic2:function(a){return i.elastic(a,2,.1,.4)},elastic3:function(a){return i.elastic(a,3,.1,.4)},elastic4:function(a){return i.elastic(a,4,.1,.4)},elastic5:function(a){return i.elastic(a,5,.1,.4)},elastic6:function(a){return i.elastic(a,6,.1,.4)},bounce:function(a){return i._bounce(a,4,5)},bounce2:function(a){return i._bounce(a,2,2)},bounce3:function(a){return i._bounce(a,3,4)},bounce4:function(a){return i._bounce(a,4,5)},bounce5:function(a){return i._bounce(a,5,7)},bounce6:function(a){return i._bounce(a,6,9)},_bounce:function(a,b,c){for(var d=[1],e=2/b/b,f=1;b>f;f++)d[d.length]=1-e*f*(f+1)/2;d[d.length]=-b*e/2;for(var f=0;f<d.length;f++)if(a>d[f])return f==d.length-1?a*a/(b*e/2)/(b*e/2):c*(a-d[f])*(a-d[f-1])+1},_elastic:function(a,b,c,d){return c>a?Math.exp(10*(a/c-1)):1+d*Math.exp(5*(c-a))*Math.sin(360*b*(a-c)/(1-c)*Math.PI/180)},bezier:function(a){if(a in R){var b=R[a];return null!=b?"cubic-bezier("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+")":"linear"}return"linear"}},b&&b.extend(b.easing,i),a.document)for(var S=["header","footer","nav","section","article","aside"],T=0;T<S.length;T++)document.createElement(S[T]);if(a.document){for(var U=!1,V=!1,W=!1,X=!1,Y=!1,T=0;T<j.length;)switch(j[T]){case"":j.splice(T,1);break;case"no-js":j.splice(T,1);break;case"ua-placeholder":U=!0,j.splice(T,1);break;case"css-placeholder":V=!0,j.splice(T,1);break;case"html-placeholder":W=!0,j.splice(T,1);break;case"event-placeholder":X=!0,j.splice(T,1);break;case"device-placeholder":Y=!0,j.splice(T,1);break;default:T++}if(U)for(var Z in c)c[Z]&&f.isBoolean(c[Z])&&j.push("ua-"+Z);if(V)for(var Z in d)if(0===Z.indexOf("has"))d[Z]&&j.push(f.camel2hyphen(Z));else if("transform"===Z)for(var $ in d[Z])d[Z][$]&&j.push("has-"+Z+"-"+$);if(W)for(var Z in e)0===Z.indexOf("has")&&e[Z]&&j.push(f.camel2hyphen(Z));if(X)for(var Z in g)0===Z.indexOf("has")&&g[Z]&&j.push(f.camel2hyphen(Z));if(Y)for(var Z in h)0===Z.indexOf("has")&&h[Z]&&j.push(f.camel2hyphen(Z));0===j.length?document.documentElement.removeAttribute("class"):document.documentElement.className=j.join(" ")}return{ua:c,css:d,html:e,util:f,event:g,device:h,easing:i}}),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},q={}.hasOwnProperty;o={inner:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},cross:function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},size:function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])},normalize:function(a){var b;return b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),[a[0]/b,a[1]/b,a[2]/b]},MM:function(a,b){var c,d,e,f,g,h,i;for(c=new Array(16),d=g=0;4>g;d=++g)for(e=h=0;4>h;e=++h)for(c[4*d+e]=0,f=i=0;4>i;f=++i)c[4*d+e]+=a[4*d+f]*b[4*f+e];return c},MV:function(a,b){return[a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],a[4]*b[0]+a[5]*b[1]+a[6]*b[2]+a[7]*b[3],a[8]*b[0]+a[9]*b[1]+a[10]*b[2]+a[11]*b[3],a[12]*b[0]+a[13]*b[1]+a[14]*b[2]+a[15]*b[3]]},VM:function(a,b){return[b[0]*a[0]+b[4]*a[1]+b[8]*a[2]+b[12]*a[3],b[1]*a[0]+b[5]*a[1]+b[9]*a[2]+b[13]*a[3],b[2]*a[0]+b[6]*a[1]+b[10]*a[2]+b[14]*a[3],b[3]*a[0]+b[7]*a[1]+b[11]*a[2]+b[15]*a[3]]},INV:function(a){var b,c,d,e;for(d=new Array(a.length),b=c=0,e=a.length;e>=0?e>c:c>e;b=e>=0?++c:--c)d[a.length-1-b]=a[b];return d},Transform:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,p,q,r;return l=d/180*Math.PI,k=e/180*Math.PI,j=f/180*Math.PI,g=Math.cos(j),m=Math.sin(j),h=Math.cos(k),n=Math.sin(k),i=Math.cos(l),p=Math.sin(l),q=1,r=[[q*g*h,q*(g*n*p-m*i),q*(g*n*i+m*p),0],[q*m*h,q*(m*n*p+g*i),q*(m*n*i-g*p),0],[q*-n,q*h*p,q*h*i,0],[0,0,0,1]],o.MV(r,[a,b,c,1])}},k=function(){function a(b){var c;if(null==b&&(b={}),!Polaris.html.hasCanvas)return void(this.canvas=null);if(this.camera=[0,0,1e3],this.lookAt=[0,0,0],this.aspect=1,this.useWebGL=(void 0===b.webgl?!0:!!b.webgl)&&Polaris.html.hasWebgl,this.objects=[],this.zSort=[],this.timerID=null,this.rendering=!1,this.angle=(b.angle||a.ANGLE)*Math.PI/180,this.fogEnabled=b.fogEnabled||0,this.fogNear=b.fogNear||a.FOG_NEAR,this.fogFar=b.fogFar||a.FOG_FAR,this.background=Polaris.util.hex2rgb(b.background),this.blurWeight=[1],this.canvas=document.createElement("canvas"),this.useWebGL&&(this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")),null!==this.gl)try{this.program=e.call(this,a.V_SHADER,a.F_SHADER),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.ALWAYS),this.gl.enable(this.gl.BLEND),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.blendEquationSeparate(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.attLocation=new Array,this.attLocation[0]=this.gl.getAttribLocation(this.program,"position"),this.attLocation[1]=this.gl.getAttribLocation(this.program,"color"),this.attStride=new Array,this.attStride[0]=3,this.attStride[1]=4,this.uniLocation=new Array,this.uniLocation[0]=this.gl.getUniformLocation(this.program,"vpMatrix"),this.uniLocation[1]=this.gl.getUniformLocation(this.program,"mMatrix"),this.uniLocation[2]=this.gl.getUniformLocation(this.program,"fogEnabled"),this.uniLocation[3]=this.gl.getUniformLocation(this.program,"fogNear"),this.uniLocation[4]=this.gl.getUniformLocation(this.program,"fogFar"),this.uniLocation[5]=this.gl.getUniformLocation(this.program,"lineWidth"),this.uniLocation[6]=this.gl.getUniformLocation(this.program,"useGlobalColor"),this.uniLocation[7]=this.gl.getUniformLocation(this.program,"globalColor"),this.programBlur=e.call(this,a.BLUR_V_SHADER,a.BLUR_F_SHADER),this.attLocationBlur=new Array,this.attLocationBlur[0]=this.gl.getAttribLocation(this.programBlur,"position"),this.attLocationBlur[1]=this.gl.getAttribLocation(this.programBlur,"color"),this.attLocationBlur[2]=this.gl.getAttribLocation(this.programBlur,"texCoord"),this.attStrideBlur=new Array,this.attStrideBlur[0]=3,this.attStrideBlur[1]=4,this.attStrideBlur[2]=2,this.uniLocationBlur=new Array,this.uniLocationBlur[0]=this.gl.getUniformLocation(this.programBlur,"vpMatrix"),this.uniLocationBlur[1]=this.gl.getUniformLocation(this.programBlur,"texture"),this.uniLocationBlur[2]=this.gl.getUniformLocation(this.programBlur,"gaussian"),this.uniLocationBlur[3]=this.gl.getUniformLocation(this.programBlur,"weight"),this.uniLocationBlur[4]=this.gl.getUniformLocation(this.programBlur,"horizontal"),this.fBuffer1=d.call(this),this.fBuffer2=d.call(this),this.fBuffer3=d.call(this),this.base=new g.Polygon(this,[new h([-1,-1,0],[0,0,0,0]),new h([1,-1,0],[0,0,0,0]),new h([1,1,0],[0,0,0,0]),new h([-1,1,0],[0,0,0,0])],[0,1,2,0,2,3],{coord:[0,0,1,0,1,1,0,1]}),this.useWebGL=!0}catch(f){c=f,console.log(c),this.useWebGL=!1}else this.useWebGL=!1;this.useWebGL||(this.contxt=this.canvas.getContext("2d"))}var b,c,d,e,f,j,k,l,m,n,p,q,r,s;for(a.NEAR=.1,a.FAR=5e3,a.ANGLE=45,a.FOG_NEAR=1e3,a.FOG_FAR=3e3,a.MAX_BLUR_SIZE=4,a.SIZE=Math.pow(2,10),a.V_SHADER="attribute vec3 position;\nattribute vec4 color;\n\nuniform mat4  vpMatrix;\nuniform mat4  mMatrix;\nuniform int   fogEnabled;\nuniform float fogNear;\nuniform float fogFar;\nuniform float lineWidth;\nuniform bool  useGlobalColor;\nuniform vec4  globalColor;\n\nvarying vec4 vColor;\nvarying float vFog;\n\nvoid main(void) {\n	if (useGlobalColor) {\n		vColor = globalColor;\n	} else {\n		vColor = color;\n	}\n\n	vec4 pos =  vpMatrix * mMatrix * vec4(position, 1.0);\n\n	if (fogEnabled == 1) {\n		vFog = clamp((fogFar - length(pos.xyz))/(fogFar - fogNear), 0.0, 1.0);\n	} else {\n		vFog = 1.0;\n	}\n	gl_Position = pos;\n\n	if (lineWidth > 0.0) {\n		gl_PointSize = lineWidth;\n	}\n}",a.F_SHADER="precision mediump float;\nvarying vec4 vColor;\nvarying float vFog;\n\nvoid main(void) {\n	gl_FragColor  = mix(vec4(1.0, 1.0, 1.0, 0.0), vColor, vFog);\n}",a.BLUR_V_SHADER="attribute vec3 position;\nattribute vec4 color;\nattribute vec2 texCoord;\nuniform   mat4 vpMatrix;\nvarying   vec2 vTexCoord;\nvarying   vec4 vColor;\n\nvoid main(void){\n	vColor = color;\n	vTexCoord   = texCoord;\n	gl_Position = vpMatrix * vec4(position, 1.0);\n}",b="",c="",j=k=m=-a.MAX_BLUR_SIZE+1,n=a.MAX_BLUR_SIZE;n>=m?n>k:k>n;j=n>=m?++k:--k)b+="rgb += texture2D(texture, (fc + vec2("+j+".0, 0.0)) * tFrag).rgb * weight["+Math.abs(j)+"];",c+="rgb += texture2D(texture, (fc + vec2(0.0, "+j+".0)) * tFrag).rgb * weight["+Math.abs(j)+"];";return a.BLUR_F_SHADER="precision mediump float;\nuniform sampler2D texture;\nuniform bool      gaussian;\nuniform float     weight["+a.MAX_BLUR_SIZE+"];\nuniform bool      horizontal;\nvarying vec2      vTexCoord;\nvarying vec4      vColor;\n\nvoid main(void) {\n	float tFrag = 1.0 / float("+a.SIZE+");\n	vec2  fc;\n	vec3  rgb = vec3(0.0, 0.0, 0.0);\n\n	if (gaussian) {\n		if(horizontal){\n			fc = gl_FragCoord.st;\n			"+b+"\n		}else{\n			fc = gl_FragCoord.st;\n			"+c+"\n		}\n	} else {\n		rgb = texture2D(texture, vTexCoord).rgb;\n	}\n	gl_FragColor = vec4(rgb, 1.0);\n}",a.prototype.getCanvas=function(){return this.canvas},a.prototype.setLookAt=function(a,b,c){return this.lookAt=[a,b,c],this},a.prototype.setCamera=function(a,b,c){return this.camera=[a,b,c],this},a.prototype.resize=function(a,b){return this.stageW=a,this.stageH=b,this.aspect=1,this.canvas.setAttribute("width",this.stageW),this.canvas.setAttribute("height",this.stageH),this.render(),this},a.prototype.addObject=function(a){return this.objects.push(a),this.objects.length-1},a.prototype.getObject=function(a){return this.objects[a]},a.prototype.removeObject=function(a){this.objects.splice(a,1)},a.prototype.render=function(){this.useWebGL&&r.call(this,f.call(this,this.camera,this.lookAt))},a.prototype.blur=function(b){var c,d,e,f,g,h,i;for(this.blurRadius=Math.max(b,0),this.blurWeight=new Array(a.MAX_BLUR_SIZE),h=0,g=this.blurRadius*this.blurRadius,j=c=0,e=this.blurWeight.length;e>=0?e>c:c>e;j=e>=0?++c:--c)i=Math.exp(-.5*j*j/g),this.blurWeight[j]=i,h+=0===j?i:2*i;for(j=d=0,f=this.blurWeight.length;f>=0?f>d:d>f;j=f>=0?++d:--d)this.blurWeight[j]/=h;this.render()},a.prototype.capture=function(a,b){var c;return this.resize(a,b),this.render(),c=new Image,c.src=this.canvas.toDataURL(),c},e=function(a,b){var c,d,e;if(e=this.gl.createShader(this.gl.VERTEX_SHADER),c=this.gl.createShader(this.gl.FRAGMENT_SHADER),d=this.gl.createProgram(),this.gl.shaderSource(e,a),this.gl.shaderSource(c,b),this.gl.compileShader(e),this.gl.compileShader(c),!this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS))throw"vShaderError : "+this.gl.getShaderInfoLog(e);if(!this.gl.getShaderParameter(c,this.gl.COMPILE_STATUS))throw"fShaderError : "+this.gl.getShaderInfoLog(c);if(this.gl.attachShader(d,e),this.gl.attachShader(d,c),this.gl.linkProgram(d),this.gl.getProgramParameter(d,this.gl.LINK_STATUS))return this.gl.useProgram(d),d;throw"program error"},d=function(){var b,c,d;return d=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,d),b=this.gl.createRenderbuffer(),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,b),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,a.SIZE,a.SIZE),this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,b),c=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,c),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,a.SIZE,a.SIZE,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,c,0),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),{f:d,d:b,t:c}},f=function(b,c){var d,e,f,g,h,i,j,k;return e=[b[0]-c[0],b[1]-c[1],b[2]-c[2]],d=[0,1,0],h=o.normalize(e),f=o.normalize(o.cross(d,h)),g=o.cross(h,f),i=1/Math.tan(this.angle/2),k=[f[0],g[0],h[0],0,f[1],g[1],h[1],0,f[2],g[2],h[2],0,-1*o.inner(b,f),-1*o.inner(b,g),-1*o.inner(b,h),1],j=[i/this.aspect,0,0,0,0,i,0,0,0,0,-a.FAR/(a.FAR-a.NEAR),-1,0,0,-a.FAR*a.NEAR/(a.FAR-a.NEAR),0],o.MM(k,j)},r=function(b){var c,d,e,f,g,h,j;for(this.gl.useProgram(this.program),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fBuffer1.f),this.gl.viewport(0,0,a.SIZE,a.SIZE),this.gl.clearColor(this.background[0]/255,this.background[1]/255,this.background[2]/255,1),this.gl.clearDepth(1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),h=this.objects,e=0,d=h.length;d>e;e++)switch(f=h[e],s.call(this,f.vbo,this.attLocation,this.attStride),this.gl.uniformMatrix4fv(this.uniLocation[0],!1,b),this.gl.uniformMatrix4fv(this.uniLocation[1],!1,f.getTransformMatrix()),this.gl.uniform1i(this.uniLocation[2],this.fogEnabled),this.gl.uniform1f(this.uniLocation[3],this.fogNear),this.gl.uniform1f(this.uniLocation[4],this.fogFar),null!==f.globalColor?(this.gl.uniform1i(this.uniLocation[6],!0),this.gl.uniform4fv(this.uniLocation[7],f.globalColor)):this.gl.uniform1i(this.uniLocation[6],!1),f.type){case i.TYPE_POLYGON:this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,f.ibo),this.gl.uniform1f(this.uniLocation[5],0),this.gl.drawElements(this.gl.TRIANGLES,f.vindex.length,this.gl.UNSIGNED_SHORT,0);break;case i.TYPE_LINE:this.gl.lineWidth(f.lineWidth),this.gl.drawArrays(this.gl.LINE_STRIP,0,f.vertex.length/3);break;case i.TYPE_DOT:this.gl.uniform1f(this.uniLocation[5],f.lineWidth),this.gl.drawArrays(this.gl.POINTS,0,f.vertex.length/3)}this.gl.useProgram(this.programBlur),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.fBuffer1.t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.blurRadius>0&&(j=o.MM(l.call(this,-1,1,1,-1,.1,1),[1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1]),this.gl.viewport(0,0,a.SIZE,a.SIZE),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fBuffer2.f),p.call(this,j,!0,!0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fBuffer3.f),this.gl.bindTexture(this.gl.TEXTURE_2D,this.fBuffer2.t),p.call(this,j,!0,!1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.fBuffer3.t)),c=this.stageW/this.stageH,g=this.stageW>this.stageH?l.call(this,-1,1,1/c,-1/c,.1,1):l.call(this,-1*c,1*c,1,-1,.1,1),j=o.MM(g,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1]),this.gl.viewport(0,0,this.stageW,this.stageH),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),p.call(this,j,!1,!1),this.gl.flush()},l=function(a,b,c,d,e,f){var g,h,i,j;return i=b-a,j=c-d,g=f-e,h=new Array,h[0]=2/i,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=2/j,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=-2/g,h[11]=0,h[12]=-(a+b)/i,h[13]=-(c+d)/j,h[14]=-(f+e)/g,h[15]=1,h},p=function(a,b,c){return this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),s.call(this,this.base.vbo,this.attLocationBlur,this.attStrideBlur),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.base.ibo),this.gl.uniformMatrix4fv(this.uniLocationBlur[0],!1,a),this.gl.uniform1i(this.uniLocationBlur[1],0),this.gl.uniform1i(this.uniLocationBlur[2],b),this.gl.uniform1fv(this.uniLocationBlur[3],this.blurWeight),this.gl.uniform1i(this.uniLocationBlur[4],c),this.gl.drawElements(this.gl.TRIANGLES,this.base.vindex.length,this.gl.UNSIGNED_SHORT,0)},s=function(a,b,c){var d,e,f;for(j=e=0,d=a.length;d>e;j=++e)f=a[j],null!==f&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,f),this.gl.enableVertexAttribArray(b[j]),this.gl.vertexAttribPointer(b[j],c[j],this.gl.FLOAT,!1,0,0))},q=function(a){},a}(),h=function(){function a(a,b){this.xyz=a,this.rgba=[1,1,1,1],this.setColor(b)}return a.prototype.setColor=function(a){Polaris.util.isArray(a)&&(void 0!==a[0]&&(this.rgba[0]=a[0]/255),void 0!==a[1]&&(this.rgba[1]=a[1]/255),void 0!==a[2]&&(this.rgba[2]=a[2]/255),void 0!==a[3]&&(this.rgba[3]=a[3])),Polaris.util.isString(a)&&a.match(/^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/)&&(this.rgba=[parseInt(RegExp.$2,16)/255,parseInt(RegExp.$3,16)/255,parseInt(RegExp.$4,16)/255,parseInt(RegExp.$1,16)/255])},a}(),i=function(){function a(b,c,d,e){null==e&&(e=null),this.type=a.TYPE_POLYGON,this.position={x:0,y:0,z:0},this.rotation={x:0,y:0,z:0},this.translation={x:0,y:0,z:0},this._position={x:0,y:0,z:0},this._rotation={x:0,y:0,z:0},this._translation={x:0,y:0,z:0},this.scale=1,this.matrix=null,this.vbo=[],this.ibo=null,this.texture=e,this.renderer=b,this.gl=b.gl,this.setPoints(c,d)}return a.TYPE_POLYGON=0,a.TYPE_LINE=1,a.TYPE_DOT=2,a.prototype.setPoints=function(a,b){var c,d,e;for(this.vertex=[],this.colors=[],this.globalColor=null,b&&(this.vindex=b),this.points=a,c=0,d=a.length;d>c;c++)e=a[c],this.vertex.push(e.xyz[0]),this.vertex.push(e.xyz[1]),this.vertex.push(e.xyz[2]),this.colors.push(e.rgba[0]),this.colors.push(e.rgba[1]),this.colors.push(e.rgba[2]),this.colors.push(e.rgba[3]);this.setBuffer()},a.prototype.getTransformMatrix=function(){var a,b,c,d,e,f,g,h,i,j,k,l;return(null===this.matrix||this.position.x!==this._position.x||this.position.y!==this._position.y||this.position.z!==this._position.z||this.rotation.x!==this._rotation.x||this.rotation.y!==this._rotation.y||this.rotation.z!==this._rotation.z||this.translation.x!==this._translation.x||this.translation.y!==this._translation.y||this.translation.z!==this._translation.z)&&(this._position.x=this.position.x,this._position.y=this.position.y,this._position.z=this.position.z,this._rotation.x=this.rotation.x,this._rotation.y=this.rotation.y,this._rotation.z=this.rotation.z,this._translation.x=this.translation.x,this._translation.y=this.translation.y,this._translation.z=this.translation.z,
h=this.rotation.x%(2*Math.PI),g=this.rotation.y%(2*Math.PI),f=this.rotation.z%(2*Math.PI),a=Math.cos(f),i=Math.sin(f),b=Math.cos(g),j=Math.sin(g),c=Math.cos(h),k=Math.sin(h),l=this.scale,d=[1,0,0,0,0,1,0,0,0,0,1,0,this.translation.x,this.translation.y,this.translation.z,1],e=[l*a*b,l*i*b,l*-j,0,l*(a*j*k-i*c),l*(i*j*k+a*c),l*b*k,0,l*(a*j*c+i*k),l*(i*j*c-a*k),l*b*c,0,this.position.x,this.position.y,this.position.z,1],this.matrix=o.MM(d,e)),this.matrix},a.prototype.setBuffer=function(){this.gl&&(this.vertex&&(this.vbo[0]=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo[0]),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vertex),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)),this.colors&&(this.vbo[1]=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo[1]),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.colors),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)),this.texture&&(this.vbo[2]=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo[2]),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.texture.coord),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)),this.vindex&&(this.ibo=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Int16Array(this.vindex),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)))},a.prototype.setGlobalColor=function(a){this.globalColor=[a[0]/255,a[1]/255,a[2]/255,a[3]],this.vbo[1]=null},a.prototype.remove=function(a){var b,c,d,e,f,g;for(f=this.renderer.objects,g=[],b=c=0,d=f.length;d>c;b=++c)e=f[b],e===this?g.push(this.renderer.removeObject(b)):g.push(void 0);return g},a}(),l=function(a){function b(a,c){b.__super__.constructor.call(this,a,c,[0,1,2])}return p(b,a),b}(i),j=function(a){function b(a,c){b.__super__.constructor.call(this,a,c,[0,1,2,0,2,3])}return p(b,a),b}(i),f=function(a){function b(a,c,d){b.__super__.constructor.call(this,a,c,null),this.type=i.TYPE_LINE,this.lineWidth=d}return p(b,a),b}(i),e=function(a){function b(a,c,d){b.__super__.constructor.call(this,a,c,null),this.type=i.TYPE_DOT,this.lineWidth=d}return p(b,a),b}(i),g={Polygon:i,Triangle:l,Rect:j,Line:f,Dots:e},a=function(){function a(a,b){var c,d,e;if(this.rendering=!1,b.colors)for(c=d=0,e=b.colors.length;e>=0?e>d:d>e;c=e>=0?++d:--d)b.colors[c]=Polaris.util.hex2rgb(b.colors[c])}return a.prototype.start=function(){this.rendering=!0,Polaris.util.onFrame(function(a){return function(b,c,d){a.rendering&&a.frame(b,Math.min(c,50),d)}}(this))},a.prototype.pause=function(){this.rendering=!1},a.prototype.resume=function(){this.rendering=!0},a.prototype.frame=function(){},a}(),b=function(a){function b(a,c){var d,e,f,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;for(b.__super__.constructor.call(this,a,c),Polaris.util.srand(c.seed),this.num=c.num,this.fogNear=c.fogNear,this.fogFar=c.fogFar,this.mouse=c.mouse,this.scroll=c.scroll,this.speed=c.speed,this.camRadius=c.camRadius,this.lines=[],this.stageW=0,this.stageH=0,this.mouseX=0,this.mouseY=0,this.angleX=0,this.angleY=0,this.renderer=new k({angle:45,fogEnabled:!0,fogNear:this.fogNear,fogFar:this.fogFar,background:c.background,webgl:!0}),this.stage=$(a),this.stage.append(this.renderer.getCanvas()),Polaris.util.onResize(function(a){return function(b,c){return a.stageW=a.stage.width(),a.stageH=a.stage.height(),a.renderer.resize(a.stageW,a.stageH)}}(this)),this.mouse&&window.addEventListener("mousemove",function(a){return function(b){return a.mouseX=-(b.clientX-.5*a.stageW)/a.stageW,a.mouseY=-(b.clientY-.5*a.stageH)/a.stageH}}(this)),i=m=0,w=this.num;w>=0?w>m:m>w;i=w>=0?++m:--m)for(v=Polaris.util.rand(c.minRadius,c.maxRadius),r=Polaris.util.rand(0,360),A=Polaris.util.rand(-100,100)/100*Math.PI*.3,B=Polaris.util.rand(-100,100)/100*Math.PI*.3,C=Polaris.util.rand(-100,100)/100*Math.PI*.3,x=c.colors,j=p=0,n=x.length;n>p;j=++p){for(e=x[j],t=[],D=[],l=0,f=q=1;360>=q;f=++q)d=c.alpha*Math.pow(f,1.5)*Math.exp(-.12*f)/10,d>.001&&(u=(f+r)/180*Math.PI,E=[(v+1*j)*Math.sin(u),0,(v+1*j)*Math.cos(u)],F=[(v+1*j)*Math.sin(u),c.width,(v+1*j)*Math.cos(u)],y=[e[0],e[1],e[2],d],t.push(new h(E,y)),t.push(new h(F,y)),D.push(2*l),D.push(2*(l+1)),D.push(2*(l+1)+1),D.push(2*l),D.push(2*(l+1)+1),D.push(2*l+1),l++);for(z=s=0;6>s;z=++s)D.splice(D.length-1,1);o=new g.Polygon(this.renderer,t,D),o.rotation.x=A+c.gap*j,o.rotation.y=B,o.rotation.z=C+c.gap*j,this.lines.push(o),this.renderer.addObject(o)}}return p(b,a),b.prototype.frame=function(a,b,c){var d,e,f,g,h,i,j,k;for(k=this.lines,h=0,i=k.length;i>h;h++)j=k[h],j.rotation.y-=b*this.speed;return d=this.scroll?this.camRadius+.2*(document.body.scrollTop||document.documentElement.scrollTop):this.camRadius,this.mouse?(this.angleX+=(this.mouseX*Math.PI*.1-this.angleX)*b*5e-4,this.angleY+=(this.mouseY*Math.PI*.1-this.angleY)*b*5e-4,e=d*Math.sin(this.angleX),f=d*Math.sin(this.angleY),g=d*Math.cos(this.angleX)):(e=0,f=200,g=d),this.renderer.setLookAt(0,0,0),this.renderer.setCamera(e,f,g),this.renderer.render()},b}(a),d=function(a){function b(a,d){var e,f,g,h,i,j,l,m;for(b.__super__.constructor.call(this,a,d),this.num=d.num,this.minRadius=d.minRadius,this.maxRadius=d.maxRadius,this.maxAlpha=d.maxAlpha,this.centerAlpha=d.centerAlpha,this.edgeAlpha=d.edgeAlpha,this.repulsion=d.repulsion,this.attraction=d.attraction,this.viscosity=d.viscosity,this.camSpeed=d.camSpeed/180*Math.PI/1e3,this.circles=[],this.renderer=new k({angle:90,fogEnabled:0,fogFar:3e3,fogNear:1500,background:d.background,webgl:!0}),this.stage=$(a),this.stageW=0,this.stageH=0,this.stage.append(this.renderer.getCanvas()),Polaris.util.onResize(function(a){return function(b,c){return a.stageW=a.stage.width(),a.stageH=a.stage.height(),a.renderer.resize(a.stageW,a.stageH)}}(this)),f=g=0,i=this.num;i>=0?i>g:g>i;f=i>=0?++g:--g)j=Polaris.util.rand(-800,800),l=Polaris.util.rand(-600,600),m=Polaris.util.rand(-800,800),h=this.minRadius+(this.maxRadius-this.minRadius)*Math.exp(-d.distribution*f/this.num),e=d.colors[f%d.colors.length],this.circles[f]=new c(this.renderer,j,l,m,h,e,this.centerAlpha,this.edgeAlpha);this.renderer.blur(d.blur)}return p(b,a),b.prototype.frame=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(q=this.circles,k=0,l=q.length;l>k;k++)h=q[k],h.force=[(0-h.polygon.position.x)*this.attraction,(0-h.polygon.position.y)*this.attraction,(0-h.polygon.position.z)*this.attraction];for(i=n=0,r=this.circles.length-1;r>=0?r>n:n>r;i=r>=0?++n:--n)for(j=o=s=i+1,t=this.circles.length;t>=s?t>o:o>t;j=t>=s?++o:--o)this.circles[i].interact(this.repulsion,this.circles[j]);for(e=800,d=c*this.camSpeed,f=e*Math.sin(d),g=e*Math.cos(d),u=this.circles,p=0,m=u.length;m>p;p++)h=u[p],h.polygon.rotation.y=d,h.update(this.viscosity,b);return this.renderer.setLookAt(0,0,0),this.renderer.setCamera(f,0,g),this.renderer.render()},b}(a),c=function(){function a(b,c,d,e,f,i,j,k){var l,m,n,o,p;for(this.radius=f,this.force=[0,0,0],this.velocity=[Polaris.util.rand(0,50)/100*(Math.random()>.5?1:-1),Polaris.util.rand(0,50)/100*(Math.random()>.5?1:-1),Polaris.util.rand(0,50)/100*(Math.random()>.5?1:-1)],this.points=[],p=[],this.points.push(new h([0,0,0],[i[0],i[1],i[2],j])),l=m=0,o=a.DIV;o>=0?o>m:m>o;l=o>=0?++m:--m)n=360*l/a.DIV*Math.PI/180,this.points.push(new h([f*Math.sin(n),this.radius*Math.cos(n),0],[i[0],i[1],i[2],k])),p.push(0),p.push((l+1)%a.DIV+1),p.push((l+2)%a.DIV+1);this.polygon=new g.Polygon(b,this.points,p),this.polygon.position.x=c,this.polygon.position.y=d,this.polygon.position.z=e,b.addObject(this.polygon)}return a.DIV=30,a.prototype.setRadius=function(b){var c,d,e,f;for(this.radius=b,c=d=0,f=a.DIV;f>=0?f>d:d>f;c=f>=0?++d:--d)e=360*c/a.DIV*Math.PI/180,this.polygon.vertex[3*(c+1)+0]=this.radius*Math.sin(e),this.polygon.vertex[3*(c+1)+1]=this.radius*Math.cos(e);this.polygon.setBuffer()},a.prototype.interact=function(a,b){var c,d;d=Math.sqrt(Math.pow(this.polygon.position.x-b.polygon.position.x,2)+Math.pow(this.polygon.position.y-b.polygon.position.y,2)+Math.pow(this.polygon.position.z-b.polygon.position.z,2)),d<this.radius+b.radius&&(c=this.radius+b.radius-d,this.force[0]+=a*(this.polygon.position.x-b.polygon.position.x)*c/Math.pow(this.radius,2),this.force[1]+=a*(this.polygon.position.y-b.polygon.position.y)*c/Math.pow(this.radius,2),this.force[2]+=a*(this.polygon.position.z-b.polygon.position.z)*c/Math.pow(this.radius,2),b.force[0]+=a*(b.polygon.position.x-this.polygon.position.x)*c/Math.pow(b.radius,2),b.force[1]+=a*(b.polygon.position.y-this.polygon.position.y)*c/Math.pow(b.radius,2),b.force[2]+=a*(b.polygon.position.z-this.polygon.position.z)*c/Math.pow(b.radius,2))},a.prototype.update=function(a,b){var c,d;for(c=d=0;3>d;c=++d)this.velocity[c]+=this.force[c]*b/2;this.polygon.position.x+=this.velocity[0]*b/a/2,this.polygon.position.y+=this.velocity[1]*b/a/2,this.polygon.position.z+=this.velocity[2]*b/a/2},a}(),m=function(a){function b(a,c){var d,e,f,i,j,l,m,n,o,p,q;for(b.__super__.constructor.call(this,a,c),this.num=c.num,this.speed=c.speed,this.minAlpha=c.minAlpha,this.maxAlpha=c.maxAlpha,this.boundsX=c.boundsX,this.boundsY=c.boundsY,this.boundsR=c.boundsR,this.renderer=new k({angle:45,fogEnabled:!1,background:c.background,webgl:c.webgl}),this.crossPoints=[],this.extendPoints=[],this.colors=[],this.triangles=[],this.stage=$(a),this.stage.append(this.renderer.getCanvas()),Polaris.util.onResize(function(a){return function(b,c){return a.renderer.resize(a.stage.width(),a.stage.height())}}(this)),d=f=0,o=this.num;o>=0?o>f:f>o;d=o>=0?++f:--f)for(e=j=0;3>j;e=++j)this.colors[3*d+e]=[c.colors[d%c.colors.length][0],c.colors[d%c.colors.length][1],c.colors[d%c.colors.length][2],0],this.crossPoints[3*d+e]=new h([Polaris.util.rand(-this.boundsX,this.boundsX),Polaris.util.rand(-this.boundsY,this.boundsY),0],this.colors[3*d+e]),this.crossPoints[3*d+e]._v=[this.speed*Polaris.util.rand(50,100)/100*(Math.random()>.5?1:-1),this.speed*Polaris.util.rand(50,100)/100*(Math.random()>.5?1:-1)],this.crossPoints[3*d+e]._c=[c.colors[d%c.colors.length][0],c.colors[d%c.colors.length][1],c.colors[d%c.colors.length][2],this.minAlpha+(this.maxAlpha-this.minAlpha)*Math.random()],this.extendPoints[2*(3*d+e)+0]=new h([0,0,0],this.colors[3*d+e]),this.extendPoints[2*(3*d+e)+1]=new h([0,0,0],this.colors[3*d+e]),this.extendPoints[2*(3*d+e)+0]._c=[c.colors[d%c.colors.length][0],c.colors[d%c.colors.length][1],c.colors[d%c.colors.length][2],0],this.extendPoints[2*(3*d+e)+1]._c=[c.colors[d%c.colors.length][0],c.colors[d%c.colors.length][1],c.colors[d%c.colors.length][2],0];for(d=l=0,p=this.num;p>=0?p>l:l>p;d=p>=0?++l:--l)this.triangles[4*d+0]=new g.Triangle(this.renderer,[this.crossPoints[3*d+0],this.crossPoints[3*d+1],this.crossPoints[3*d+2]]),this.triangles[4*d+1]=new g.Triangle(this.renderer,[this.crossPoints[3*d+0],this.extendPoints[6*d+0],this.extendPoints[6*d+1]]),this.triangles[4*d+2]=new g.Triangle(this.renderer,[this.crossPoints[3*d+1],this.extendPoints[6*d+2],this.extendPoints[6*d+2]]),this.triangles[4*d+3]=new g.Triangle(this.renderer,[this.crossPoints[3*d+2],this.extendPoints[6*d+4],this.extendPoints[6*d+5]]);for(q=this.triangles,n=0,i=q.length;i>n;n++)m=q[n],this.renderer.addObject(m)}var c;return p(b,a),b.prototype.frame=function(a,b,d){var e,f,g,h,i,j,k;for(e=g=0,j=this.num;j>=0?j>g:g>j;e=j>=0?++g:--g)for(f=h=0;3>h;f=++h)this.crossPoints[3*e+f].xyz[0]+=this.crossPoints[3*e+f]._v[0]*b,this.crossPoints[3*e+f].xyz[1]+=this.crossPoints[3*e+f]._v[1]*b,this.crossPoints[3*e+f].rgba[3]+=.005*(this.crossPoints[3*e+f]._c[3]-this.crossPoints[3*e+f].rgba[3]),this.extendPoints[2*(3*e+f)+0].rgba[3]+=.005*(this.extendPoints[2*(3*e+f)+0]._c[3]-this.extendPoints[2*(3*e+f)+0].rgba[3]),this.extendPoints[2*(3*e+f)+1].rgba[3]+=.005*(this.extendPoints[2*(3*e+f)+1]._c[3]-this.extendPoints[2*(3*e+f)+1].rgba[3]),(this.crossPoints[3*e+f].xyz[0]>this.boundsX||this.crossPoints[3*e+f].xyz[0]<-this.boundsX)&&(this.crossPoints[3*e+f]._v[0]=this.speed*Polaris.util.rand(50,100)/100*(this.crossPoints[3*e+f]._v[0]>0?-1:1),this.crossPoints[3*e+f]._c[3]=this.minAlpha+(this.maxAlpha-this.minAlpha)*Math.random()),(this.crossPoints[3*e+f].xyz[1]>this.boundsY||this.crossPoints[3*e+f].xyz[1]<-this.boundsY)&&(this.crossPoints[3*e+f]._v[1]=this.speed*Polaris.util.rand(50,100)/100*(this.crossPoints[3*e+f]._v[1]>0?-1:1),this.crossPoints[3*e+f]._c[3]=this.minAlpha+(this.maxAlpha-this.minAlpha)*Math.random()),this.extendPoints[2*(3*e+f)+0].xyz=c.call(this,3*e+f,3*e+(f+1)%3),this.extendPoints[2*(3*e+f)+1].xyz=c.call(this,3*e+f,3*e+(f+2)%3);for(e=i=0,k=this.num;k>=0?k>i:i>k;e=k>=0?++i:--i)this.triangles[4*e+0].setPoints([this.crossPoints[3*e+0],this.crossPoints[3*e+1],this.crossPoints[3*e+2]]),this.triangles[4*e+1].setPoints([this.crossPoints[3*e+0],this.extendPoints[6*e+0],this.extendPoints[6*e+1]]),this.triangles[4*e+2].setPoints([this.crossPoints[3*e+1],this.extendPoints[6*e+2],this.extendPoints[6*e+3]]),this.triangles[4*e+3].setPoints([this.crossPoints[3*e+2],this.extendPoints[6*e+4],this.extendPoints[6*e+5]]);this.renderer.setLookAt(0,0,0),this.renderer.setCamera(0,0,2500),this.renderer.render()},c=function(a,b){var c,d,e,f,g,h;return g=this.crossPoints[a].xyz,h=this.crossPoints[b].xyz,c=0,d=0,e=Math.abs(h[0]-g[0])>.05?h[0]-g[0]:.01*Math.floor(h[0]-g[0]/1e4),f=Math.abs(h[1]-g[1])>.05?h[1]-g[1]:.01*Math.floor(h[1]-g[1]/1e4),f>e?(d=g[1]<h[1]?2*-this.boundsY:2*+this.boundsY,c=e/f*(d-g[1])+g[0]):(c=g[0]<h[0]?2*-this.boundsX:2*+this.boundsX,d=f/e*(c-g[0])+g[1]),[c,d,0]},b}(a),n=function(a){function b(a,c){var d,e,f,i,j,l,m,n,o,p,q,r;for(b.__super__.constructor.call(this,a,c),Polaris.util.srand(c.seed),this.num=c.num,this.speed=c.speed,this.alpha=c.alpha,this.minSize=c.minSize,this.maxSize=c.maxSize,this.camSpeed=c.camSpeed,this.mouse=c.mouse,this.stageW=0,this.stageH=0,this.mouseX=0,this.mouseY=0,this.angleX=0,this.angleY=0,this.renderer=new k({angle:45,fogEnabled:!1,background:c.background,webgl:c.webgl}),this.colors=[],this.triangles=[],this.stage=$(a),this.stage.append(this.renderer.getCanvas()),Polaris.util.onResize(function(a){return function(b,c){return a.stageW=a.stage.width(),a.stageH=a.stage.height(),a.renderer.resize(a.stageW,a.stageH)}}(this)),this.mouse&&window.addEventListener("mousemove",function(a){return function(b){return a.mouseX=-(b.clientX-.5*a.stageW)/a.stageW,a.mouseY=-(b.clientY-.5*a.stageH)/a.stageH}}(this)),e=f=0,n=this.num;n>=0?n>f:f>n;e=n>=0?++f:--f)m=this.minSize+(this.maxSize-this.minSize)*Polaris.util.rand(0,100)/100,o=c.colors[e%c.colors.length],p=[o[0],o[1],o[2],this.alpha],q=[o[0],o[1],o[2],0],i=[m*Math.sin(0*Math.PI*2/3),m*Math.cos(0*Math.PI*2/3),0],j=[m*Math.sin(1*Math.PI*2/3),m*Math.cos(1*Math.PI*2/3),0],l=[m*Math.sin(2*Math.PI*2/3),m*Math.cos(2*Math.PI*2/3),0],d=c.extension,r=new g.Polygon(this.renderer,[new h(i,p),new h(j,p),new h(l,p),new h([d*(i[0]-j[0])+i[0],d*(i[1]-j[1])+i[1],0],q),new h([d*(i[0]-l[0])+i[0],d*(i[1]-l[1])+i[1],0],q),new h([d*(j[0]-l[0])+j[0],d*(j[1]-l[1])+j[1],0],q),new h([d*(j[0]-i[0])+j[0],d*(j[1]-i[1])+j[1],0],q),new h([d*(l[0]-i[0])+l[0],d*(l[1]-i[1])+l[1],0],q),new h([d*(l[0]-j[0])+l[0],d*(l[1]-j[1])+l[1],0],q)],[0,1,2,3,0,4,5,1,6,7,2,8]),r.position.x=c.centerRand*Polaris.util.rand(0,100)/100,r.position.y=c.centerRand*Polaris.util.rand(0,100)/100,r.position.z=c.centerRand*Polaris.util.rand(0,100)/100,r.rotation.x=c.rotateX?Polaris.util.rand(0,100)/100*Math.PI:0,r.rotation.y=c.rotateY?Polaris.util.rand(0,100)/100*Math.PI:0,r.rotation.z=c.rotateZ?Polaris.util.rand(0,100)/100*Math.PI:0,r.speed={x:c.rotateX?this.speed*Polaris.util.rand(50,100)/100*(0!==Polaris.util.rand(0,1)?1:-1):0,y:c.rotateY?this.speed*Polaris.util.rand(50,100)/100*(0!==Polaris.util.rand(0,1)?1:-1):0,z:c.rotateZ?this.speed*Polaris.util.rand(50,100)/100*(0!==Polaris.util.rand(0,1)?1:-1):0},this.triangles.push(r),this.renderer.addObject(r)}return p(b,a),b.prototype.frame=function(a,b,c){var d,e,f,g,h,i,j;for(i=this.triangles,g=0,h=i.length;h>g;g++)j=i[g],j.rotation.x+=b*j.speed.x,j.rotation.y+=b*j.speed.y,j.rotation.z+=b*j.speed.z;this.mouse&&(this.angleY+=(this.mouseY*Math.PI*.4-this.angleY)*b*5e-4),d=2500*Math.cos(this.angleY)*Math.sin(c*this.camSpeed),e=2500*Math.sin(this.angleY),f=2500*Math.cos(this.angleY)*Math.cos(c*this.camSpeed),this.renderer.setLookAt(0,0,0),this.renderer.setCamera(d,e,f),this.renderer.render()},b}(a),window.E3={Circles:d,Triangles:m,Bands:b}}.call(this);